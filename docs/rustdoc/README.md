# ShardX API ドキュメント

このディレクトリには、ShardXのRustdocによって生成されたAPIドキュメントが含まれています。

## ドキュメントの生成方法

ドキュメントを生成するには、以下のコマンドを実行します：

```bash
cargo doc --no-deps --document-private-items --open
```

このコマンドは、依存関係を除外し、プライベート項目も含めてドキュメントを生成し、ブラウザで開きます。

## ドキュメントの構造

ドキュメントは以下の構造で整理されています：

- **モジュール**: ShardXの各機能モジュール（シャーディング、トランザクション処理など）
- **構造体**: データ構造の定義と実装
- **列挙型**: 状態や種類を表す列挙型
- **トレイト**: インターフェースの定義
- **関数**: ユーティリティ関数

## ドキュメントの書き方

ShardXプロジェクトでは、以下のドキュメント規約に従ってください：

### モジュールドキュメント

モジュールの先頭に、そのモジュールの目的と主要な機能を説明するドキュメントを追加します：

```rust
//! # シャーディングモジュール
//!
//! このモジュールは、ShardXのシャーディング機能を提供します。
//! シャーディングは、データベースを複数の小さな部分（シャード）に分割し、
//! スケーラビリティを向上させる技術です。
//!
//! ## 主な機能
//!
//! - シャード作成と管理
//! - シャード間のデータ同期
//! - クロスシャードトランザクション処理
//! - シャードの再バランシング
```

### 構造体とメソッドのドキュメント

構造体とそのメソッドには、詳細な説明とパラメータの説明を追加します：

```rust
/// シャードマネージャー
///
/// シャードの作成、管理、同期を担当するコンポーネント。
pub struct ShardManager {
    // フィールド
}

impl ShardManager {
    /// 新しいシャードを作成します。
    ///
    /// # 引数
    ///
    /// * `shard_id` - シャードの一意識別子
    /// * `config` - シャード設定
    ///
    /// # 戻り値
    ///
    /// 作成されたシャードのインスタンス、またはエラー
    ///
    /// # エラー
    ///
    /// 以下の場合にエラーを返します：
    /// - 指定されたIDのシャードが既に存在する場合
    /// - シャードの作成に必要なリソースが不足している場合
    ///
    /// # 例
    ///
    /// ```
    /// use shardx::shard::{ShardManager, ShardConfig};
    ///
    /// let manager = ShardManager::new();
    /// let config = ShardConfig::default();
    /// let shard = manager.create_shard("shard-1", config).unwrap();
    /// ```
    pub fn create_shard(&self, shard_id: &str, config: ShardConfig) -> Result<Shard, Error> {
        // 実装
    }
}
```

### 列挙型のドキュメント

列挙型には、各バリアントの説明を追加します：

```rust
/// シャードの状態を表す列挙型
#[derive(Debug, Clone, PartialEq, Eq)]
pub enum ShardStatus {
    /// 初期化中
    Initializing,
    /// アクティブ（正常に動作中）
    Active,
    /// 同期中（他のシャードとデータを同期中）
    Syncing,
    /// 停止中（メンテナンスまたはエラーにより停止中）
    Stopping,
    /// 停止済み
    Stopped,
    /// エラー状態
    Error,
}
```

### トレイトのドキュメント

トレイトには、その目的と実装者が満たすべき要件を説明します：

```rust
/// シャード操作のインターフェース
///
/// このトレイトは、シャードに対する基本操作を定義します。
/// シャードの実装はこのトレイトを実装する必要があります。
pub trait ShardOperations {
    /// シャードにデータを書き込みます。
    ///
    /// # 引数
    ///
    /// * `key` - データのキー
    /// * `value` - 書き込むデータ
    ///
    /// # 戻り値
    ///
    /// 成功した場合は`Ok(())`、失敗した場合は`Err`
    fn write(&self, key: &[u8], value: &[u8]) -> Result<(), Error>;

    /// シャードからデータを読み取ります。
    ///
    /// # 引数
    ///
    /// * `key` - 読み取るデータのキー
    ///
    /// # 戻り値
    ///
    /// 成功した場合はデータを含む`Ok(Option<Vec<u8>>)`、
    /// 失敗した場合は`Err`
    fn read(&self, key: &[u8]) -> Result<Option<Vec<u8>>, Error>;

    /// シャードからデータを削除します。
    ///
    /// # 引数
    ///
    /// * `key` - 削除するデータのキー
    ///
    /// # 戻り値
    ///
    /// 成功した場合は`Ok(())`、失敗した場合は`Err`
    fn delete(&self, key: &[u8]) -> Result<(), Error>;
}
```

## ドキュメントのベストプラクティス

1. **完全性**: すべての公開API要素（モジュール、構造体、関数など）にドキュメントを追加する
2. **明確さ**: 簡潔かつ明確な言葉で説明する
3. **例**: 可能な限り使用例を含める
4. **エラー**: 発生する可能性のあるエラーとその条件を説明する
5. **パラメータ**: すべてのパラメータの目的と型を説明する
6. **戻り値**: 戻り値の意味と型を説明する
7. **リンク**: 関連する他のAPIへのリンクを含める
8. **フォーマット**: Markdownフォーマットを使用して読みやすくする

## ドキュメントの検証

ドキュメントに含まれるコード例が正しく動作することを確認するために、以下のコマンドを実行します：

```bash
cargo test --doc
```

このコマンドは、ドキュメント内のコード例をテストとして実行します。